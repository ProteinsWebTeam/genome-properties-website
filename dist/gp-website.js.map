{"version":3,"file":"gp-website.js","sources":["../src/genprop-parser.js","../src/rst-renderer.js","../src/genprop-hierarchy.js","../src/genprop-property.js","../src/genprop-viewer.js","../src/index.js"],"sourcesContent":["const mainKeys = {\n  AC: 'accession',\n  AU: 'author',\n  DE: 'name',\n  TP: 'type',\n  TH: 'threshold',\n};\nconst refKeys = {\n  RM:\t'PMID',\n  RT:\t'title',\n  RA:\t'author',\n  RL:\t'citation',\n}\nconst stepKeys = {\n  ID:\t'id',\n  DN:\t'name',\n  RQ:\t'requires',\n}\nconst parseGenProp = (txt) => {\n  const property = {\n    references: [],\n    databases: [],\n    steps: [],\n    description: '',\n    notes: '',\n  };\n  let currentRef = null;\n  let currentDB = null;\n  let currentStep = null;\n  let currentEV = null;\n  txt.split('\\n').forEach(line=>{\n    const key = line.substr(0,2);\n    const value = line.substr(3).trim();\n    if (key in mainKeys) property[mainKeys[key]] = value;\n\n    // References\n    if (key === 'RN') {\n      currentRef = {\n        number: Number(value.replace('[','').replace(']','')),\n        title: '',\n      }\n      property.references.push(currentRef);\n    }\n    if (key in refKeys && currentRef) {\n      if (key === 'RT') {\n        currentRef.title += value;\n      } else {\n        currentRef[refKeys[key]] = value;\n      }\n    }\n    // Databases\n    if (key === 'DC') {\n      currentDB = {title: value}\n      property.databases.push(currentDB);\n    }\n    if (key === 'DR' && currentDB) currentDB['link'] = value;\n\n    // Description\n    if (key === 'CC') property.description += value + ' ';\n\n    // Notes\n    if (key === '**') property.notes += value + ' ';\n\n    // Steps\n    if (key === 'SN') {\n      currentStep = {\n        number: Number(value),\n        evidence_list: [],\n      }\n      property.steps.push(currentStep);\n    }\n    if (key in stepKeys && currentStep) currentStep[stepKeys[key]] = value;\n    // Evidence\n    if (key === 'EV' && currentStep) {\n      currentEV = {evidence: value}\n      currentStep.evidence_list.push(currentEV);\n    }\n    if (key === 'TG' && currentStep && currentEV) currentEV['go'] = value;\n\n  });\n  return property;\n  // console.log(property);\n  // return `<pre>${JSON.stringify(property, null, '  ')}</pre>`;\n};\n\n\nexport default parseGenProp;\n","import showdown from \"showdown\";\n\nconst blockType = {\n  SUBSTITUTION: 1,\n  INCLUDE: 2,\n  OTHER:-1,\n}\n\nexport class RstRenderer {\n  constructor(server, manager){\n    this.converter = new showdown.Converter();\n    this.server = server;\n    this.substitutions = {};\n    this.manager = manager;\n  }\n\n  parseBlock(block){\n    const obj = {};\n    const lines = block.split('\\n');\n    const parts  = lines[0].split('|');\n    if (parts.length==3 && parts[0].trim()==='..'){\n      obj.type = blockType.SUBSTITUTION;\n      obj.key = parts[1];\n      const value = parts[2].split('::');\n      obj.value = {\n        type: value[0].trim(),\n        value: value[1].trim(),\n        attributes: {}\n      }\n    } else {\n      const parts2  = lines[0].split(' ');\n      if (parts2.length==3 && parts2[1]===\"include::\"){\n        obj.type = blockType.INCLUDE;\n        obj.value = parts2[2];\n      }else{\n        obj.type = blockType.OTHER;\n        obj.value = lines[0].substr(3);\n      }\n    }\n    for (let i=1;i<lines.length;i++){\n      if (obj.type === blockType.SUBSTITUTION){\n        const attr = lines[i].split(':');\n        if (attr.length > 2 && attr[1].trim() !== \"\"){\n          obj.value.attributes[attr[1]] = attr.slice(2).join(':');\n        }\n      } else {\n        obj.value += lines[i].trim()\n      }\n    }\n    return obj;\n  }\n\n  extractBlocks(txt){\n    let block = '';\n    let text = txt.split('\\n').map(line => {\n      if (line.indexOf('..')===0) {\n        block += line+'\\n';\n        return '';\n      }\n      if (block !== ''){\n        if (line.indexOf('  ')===0 && line.trim()!==''){\n          block += line+'\\n';\n          return '';\n        }else{\n          const objBlock = this.parseBlock(block);\n          switch (objBlock.type){\n            case blockType.SUBSTITUTION:\n              this.substitutions[objBlock.key] = objBlock;\n              break;\n            case blockType.INCLUDE:\n              return this.manager.getResource(\n                `INCLUDE_${objBlock.value}`,\n                `${this.server}/docs/${objBlock.value}`,\n                this.markup2html.bind(this),\n                `INCLUDE_${objBlock.value}`,\n                false\n              );\n              // return 'INCLUDE: '+objBlock.value;\n          }\n          block='';\n        }\n      }\n      return line;\n    }).join('\\n');\n\n    return text;\n  }\n  renderHTMLAtrributes(list, ignore=[]){\n    return Object.keys(list)\n      .filter(k=>ignore.indexOf(k)===-1)\n      .map(k=>k+`=\"${list[k]}\"`)\n      .join(\"\");\n  }\n  applySubstitutions(txt) {\n    let newText = txt;\n    for (const key in this.substitutions){\n      const value = this.substitutions[key].value;\n      let replacement = '';\n      if (value.type==\"image\"){\n        replacement = `<img src=\"${this.server}/docs/${value.value}\" ${\n          this.renderHTMLAtrributes(value.attributes, ['alt','target'])\n        }/>`;\n        if (\"target\" in value.attributes)\n          replacement = `<a href=\"${value.attributes.target}\" ${\n            this.renderHTMLAtrributes(value.attributes, ['value', 'target'])\n          }>${\n            replacement\n          }</a>`\n      } else {\n        replacement = value.value;\n      }\n      // console.log(`|${key}|`,replacement);\n      newText = newText.replace(`|${key}|`,replacement);\n    }\n    return newText;\n  }\n  toMDTables(txt) {\n    let onTable = false;\n    return txt.split('\\n').map(l=>{\n      const isRow = l.indexOf('+--')===0;\n      const partOfTable = l.indexOf('|')===0;\n      if (!onTable && isRow){\n        onTable=true;\n        return '<div style=\"text-align: center;margin: 10px auto;\"><table>';\n      }\n      if (onTable && isRow) return '';\n      if (onTable && !isRow && partOfTable){\n        return '<tr><td>'+l.split('|').slice(1,-1).join('</td><td>')+'</td></tr>'\n      }\n      if (onTable && !isRow && !partOfTable){\n        onTable = false;\n        return '</table></div>';\n      }\n      return l;\n    }).join('\\n');\n  }\n  addHyperLinks(txt){\n    const re = /`([a-zA-Z\\-:@/\\.\\d]+)\\s<([a-zA-Z\\-:@/\\.\\d?=&]+)>`_/g;\n    return txt.replace(re, '<a href=\"$2\">$1</a>');\n  }\n  markup2html (txt) {\n    let text = this.addHyperLinks(txt);\n    text = this.extractBlocks(text);\n    text = this.applySubstitutions(text);\n    text = this.toMDTables(text)\n    return '<br/>'+this.converter.makeHtml(text);\n  }\n\n}\n","export const expandElement = element => {\n  element.innerHTML = '▾';\n  if (element.parentNode.parentNode)\n    element.parentNode.parentNode.classList.add(\"expanded\");\n}\nexport const collapseElement = element => {\n  element.innerHTML = '▸';\n  element.parentNode.parentNode.classList.remove(\"expanded\");\n}\nexport const searchHierarchy = term => {\n  document.querySelectorAll(\".genome-property a.expander\")\n    .forEach(e => collapseElement(e));\n  document.querySelectorAll('span.genprop-label')\n    .forEach(e => e.classList.remove(\"search-match\"));\n  if (term.trim()!=='')\n    document.querySelectorAll(`span.genprop-label[text*=\"${term}\"]`)\n      .forEach(e => {\n        e.classList.add(\"search-match\");\n        expandParents(e.parentNode.parentNode);\n      });\n}\nexport const expandParents = element => {\n  if (element.parentNode.parentNode.classList.contains('genome-property')){\n    element.parentNode.parentNode.classList.add(\"expanded\");\n    expandParents(element.parentNode.parentNode);\n  }\n}\nexport const renderGenPropHierarchy = (hierarchy, expanded=true, level=1) => {\n  // console.log(hierarchy)\n  return `\n  <div class=\"genome-property ${expanded?'expanded':''}\">\n    <header>\n      ${!hierarchy.children.length?'・':`\n      <a style=\"border: 0;color: darkred;\" class=\"expander\">${expanded?'▾':'▸'}</a>\n      `}\n      <span class=\"genprop-label\" text=\"${hierarchy.id} ${hierarchy.name}\">\n        <a href=\"#${hierarchy.id}\">${hierarchy.id}</a>:\n        <a href=\"#${hierarchy.id}\">${hierarchy.name}</a>\n      </span>\n    </header>\n    ${!hierarchy.children.length?'':`\n      <div class=\"children\" style=\"\n        margin-left: ${level*10}px;\n      \">\n        ${hierarchy.children\n          .map(child => renderGenPropHierarchy(child, false, level+1))\n          .join('')}\n      </div>\n    `}\n  </div>\n  `;\n}\nexport const renderGenPropHierarchyPage = (txt) => {\n  let payload = `<div>\n                  <input type=\"text\" id=\"genprop-searcher\" placeholder=\"Search\" />\n                  <a class=\"expand-all\">Expand All</a> |\n                  <a class=\"collapse-all\">Collapse All</a>\n                </<div><br/><br/>`;\n  payload += renderGenPropHierarchy(JSON.parse(txt));\n  return payload;\n}\n","class GenPropRenderer {\n  renderGenProp(property){\n    const isCategory = property.type === 'CATEGORY';\n    return `\n      <h2>${property.accession} - ${property.name}</h2>\n      <span class=\"tag\">Type: ${property.type}</span>\n      <br/><br/>\n      <div>Author: ${property.author}</div>\n      <br/>\n      <div>\n        <h4>Description</h4>\n        <p>${this.renderDescription(property.description, property.accession)}</p>\n      </div>\n      <div>\n        <h4>References</h4>\n        ${property.references && property.references.length ?\n          this.renderReferences(property.references, property.accession) :\n          '<cite>None</cite>'\n        }\n      </div>\n      <div>\n        ${isCategory ? this.renderChildren(property) : this.renderSteps(property)}\n      </div>\n      <div>\n        <h4>Database Links</h4>\n        ${property.databases && property.databases.length ? `\n          <ul>\n            ${property.databases.map(db => `\n              <li>${this.renderDatabaseLink(db.title, db.link)}</li>\n            `).join('')}\n          </ul>\n          ` : '<cite>None</cite>'\n        }\n      </div>\n    `;\n  }\n  renderDescription(txt, acc){\n    return txt.replace(/\\[(\\d+)\\]/g, `<a href=\"#${acc}-$1\">[$1]</a>`);\n  }\n  renderReferences(references, accession){\n    return `\n      <ul class=\"references\">\n        ${references.map(ref => `\n            <li class=\"reference\" id=\"${accession}-${ref.number}\">\n              <span class=\"index\">[${ref.number}]</span>\n              <span class=\"authors\">${ref.author}</span>\n              <span class=\"title\">${ref.title}</span>\n              <span class=\"citation\">${ref.citation}</span>\n              <span class=\"reference_id\">${ref.PMID}</span>\n              <a target=\"_blank\" rel=\"noopener\" href=\"https://europepmc.org/abstract/MED/${ref.PMID}\">EuropePMC</a>\n            </li>\n        `).join('')}\n      </ul>\n    `;\n  }\n  renderChildren(property){\n    return `\n    <div>\n      <h4>Genome properties</h4>\n      <table class=\"no-stripe\" style=\" background-color:#86a5bb;\">\n        <tr style=\"background-color: #ddd\">\n          <th width=\"30%\">Property</td>\n          <th style=\"text-align: left;\">Accession</th>\n        </tr>\n\n        ${property.steps.map((step,j) => `\n          <tr style=\"background-color: ${j%2==0?\"white\":\"#eee\"}\">\n            <td rowspan=\"${step.evidence_list.length}\">\n              ${step.number}. ${this.getFirstEvidenceLink(step.evidence_list, step.id)}\n            </td>\n              ${step.evidence_list.map((e,i) => `\n                ${i>0?`<tr style=\"background-color: ${j%2==0?\"white\":\"#eee\"}\">`:\"\"}\n                  <td>${this.renderEvidence(e.evidence)}</td>\n                ${i>0?\"</tr>\":\"\"}\n              `).join('')}\n          </tr>\n        `).join('')}\n      </table>\n    </div>\n    `;\n  }\n  renderSteps(property){\n    return `\n    <div>\n      <h4>Steps</h4>\n      <table class=\"no-stripe\" style=\" background-color:#86a5bb;\">\n        <tr style=\"background-color: #ddd\">\n          <th width=\"30%\">Step</td>\n          <th style=\"text-align: left;\">Evidence</th>\n          <th style=\"text-align: left;\">Go Terms</th>\n        </tr>\n\n        ${property.steps.map((step,j) => `\n          <tr style=\"background-color: ${j%2==0?\"white\":\"#eee\"}\">\n            <td rowspan=\"${step.evidence_list.length}\">${step.number}. ${step.id}\n              ${step.requires!==\"1\"?'<br/><span class=\"tag secondary\">Optional</span>':''}\n            </td>\n              ${step.evidence_list.map((e,i) => `\n                ${i>0?`<tr style=\"background-color: ${j%2==0?\"white\":\"#eee\"}\">`:\"\"}\n                  <td>${this.renderEvidence(e.evidence)}</td>\n                  <td>${this.renderEvidence(e.go)}</td>\n                ${i>0?\"</tr>\":\"\"}\n              `).join('')}\n              ${!step.evidence_list.length && \"<td><cite>None</cite></td><td><cite>None</cite></td>\"}\n          </tr>\n        `).join('')}\n      </table>\n      <span\n        data-tooltip\n        aria-haspopup=\"true\"\n        data-disable-hover=\"false\"\n        class=\"has-tip tag secondary\"\n        title=\"The threshold value is the number of required (non-optional) steps found, above which a value of PARTIAL is set for the property. Partial can be thought of as some evidence of the property. A full YES state is only defined where ALL required steps are found.\"\n      >\n          Threshold: ${property.threshold}\n      </span>\n    </div>\n    `;\n  }\n  renderDatabaseLink(title, link){\n    let a = link;\n    const parts = link.split(';').map(p => p.trim());\n    if (parts[0] === 'KEGG')\n      a = `<a\n        href=\"http://www.genome.jp/dbget-bin/www_bget?pathway:${parts[1]}\"\n      >KEGG</a>`;\n    else if (parts[0] === 'IUBMB')\n      a = `<a\n        href=\"http://www.chem.qmul.ac.uk/iubmb/enzyme/reaction/${parts[1]}/${parts[2]}.html\"\n      >IUBMB</a>`\n    else if (parts[0] === 'MetaCyc')\n      a = `<a\n        href=\"https://metacyc.org/META/NEW-IMAGE?type=NIL&object=${parts[1]}\"\n      >MetaCyc</a>`\n    return `<b>${title}</b>: ${a}`;\n  }\n  getFirstEvidenceLink(evidence_list, text){\n    if (evidence_list && evidence_list.length) {\n      const gp = evidence_list[0].evidence.trim().replace(';', '');\n      return `<a href=\"#${gp}\">${text}</a>`;\n    }\n    return '';\n  }\n  renderEvidence(txt){\n    if (!txt) return '<cite>None</cite>';\n    const parts = txt.split(';');\n    return parts\n      .filter(p => p.trim()!=='' && p.trim()!=='sufficient')\n      .map(t => {\n        const term = t.trim();\n        if (term.startsWith(\"GO:\"))\n          return `<a href=\"http://www.ebi.ac.uk/QuickGO/GTerm?id=${term}\">${term}</a>`\n        if (term.startsWith(\"GenProp\"))\n          return `<a href=\"#${term}\">${term}</a>`\n        if (term.startsWith(\"IPR\"))\n          return `<a href=\"https://www.ebi.ac.uk/interpro/entry/${term}\">${term}</a>`\n        if (term.startsWith(\"TIGR\"))\n          return `<a href=\"http://www.jcvi.org/cgi-bin/tigrfams/HmmReportPage.cgi?acc=${term}\">${term}</a>`\n        else {\n          return term;\n        }\n      }).join(' - ')\n  }\n}\n\nexport default GenPropRenderer;\n","class ViewerRenderer {\n  constructor(github) {\n    this.github = github;\n  }\n  getViewerHTML() {\n    return `\n      <div class=\"container\">\n        <div class=\"top-block\">\n            <div id=\"gp-controllers\" class=\"top-controllers\">\n                <div>\n                    <header>Load Genome Properties</header>\n                    <ul>\n                        <li><label for=\"tax-search\">From Taxonomy:</label>\n                            <input type=\"text\" id=\"tax-search\">\n                        </li>\n                        <li>\n                            <label for=\"newfile\">From a File: </label>\n                            <input type=\"file\" id=\"newfile\"/>\n                        </li>\n                    </ul>\n                </div>\n                <div>\n                    <header>Filter Properties</header>\n                    <ul>\n                        <li><label for=\"gp-selector\">By Top level category:</label>\n                            <div id=\"gp-selector\" class=\"selector\"></div>\n                        </li>\n                        <li><label for=\"gp-filter\">by Text:</label>\n                            <input type=\"text\" id=\"gp-filter\">\n                        </li>\n                    </ul>\n                </div>\n                <div>\n                    <header>Labels</header>\n                    <ul>\n                      <li><label for=\"tax_label\">Species:</label>\n                          <select id=\"tax_label\">\n                              <option value=\"name\">Species</option>\n                              <option value=\"id\">Tax ID</option>\n                              <option value=\"both\">Both</option>\n                          </select>\n                      </li>\n                        <li><label for=\"gp_label\">Properties:</label>\n                            <select id=\"gp_label\">\n                                <option value=\"name\">Name</option>\n                                <option value=\"id\">ID</option>\n                                <option value=\"both\">Both</option>\n                            </select>\n                        </li>\n                        <li>\n                          <button id=\"toggle-tax\" class=\"button secondary\">\n                            Hide Taxonomy\n                          </button>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"gp-legends\">\n                    <header>Legends</header>\n                </div>\n                <a class=\"minimise\"></a>\n            </div>\n        </div>\n        <div id=\"gp-viewer\"></div>\n        <div class=\"info-tooltip\"></div>\n    </div>`\n  }\n  loadViewer(){\n    var d3 = gpv.d3,\n            GenomePropertiesViewer = gpv.GenomePropertiesViewer,\n            viewer = new GenomePropertiesViewer({\n                element_selector: \"#gp-viewer\",\n                controller_element_selector: \"#gp-selector\",\n                server: `${this.github}/flatfiles/gp_assignments/SUMMARY_FILE_{}.gp`,\n                hierarchy_path: `${this.github}/flatfiles/hierarchy.json`,\n                server_tax: `${this.github}/flatfiles/taxonomy.json`,\n                height: 400\n            });\n      window.viewer = viewer;\n      let showTaxonomy = true;\n\n      viewer.gp_taxonomy.show_tree = showTaxonomy;\n\n      d3.select(\".minimise\").on(\"click\",(d,i,c)=>{\n          const on = d3.select(c[i]).classed(\"on\");\n          d3.selectAll(\".top-controllers>div\")\n                  .style(\"max-height\", on?\"0px\":\"500px\")\n                  .style(\"overflow\", on?null:\"hidden\")\n                  .transition(200)\n                  .style(\"max-height\", on?\"500px\":\"0px\")\n                  .style(\"opacity\", on?1:0);\n          d3.selectAll(\".top-controllers\").transition(200).style(\"padding\", on?\"5px\":\"0px\");\n          d3.select(c[i]).classed(\"on\", !on);\n      });\n      d3.select(\"#toggle-tax\").on(\"click\",(d,i,c)=>{\n          d3.select(c[i]).text(showTaxonomy ? \"Show Taxonomy\" : \"Hide Taxonomy\");\n          showTaxonomy = !showTaxonomy;\n          viewer.gp_taxonomy.show_tree = showTaxonomy;\n          viewer.update_viewer();\n      });\n  }\n}\nexport default ViewerRenderer;\n","import parseGenProp from \"./genprop-parser\";\nimport {RstRenderer} from \"./rst-renderer\";\nimport {\n  renderGenPropHierarchyPage,\n  expandElement,\n  collapseElement,\n  searchHierarchy\n} from \"./genprop-hierarchy\"\nimport GenPropRenderer from \"./genprop-property\";\nimport ViewerRenderer from \"./genprop-viewer\";\n\nconst gp_server = 'http://localhost/cgi-bin/test.pl';\n\nfunction isIpproLine(line){\n    const parts = line.split('\\t');\n    const uniprot = /[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}/;\n    return !(parts.length < 11 || !uniprot.test(parts[0]) || parts[1].length !== 32);\n}\n\nclass GenomePropertiesWebsite {\n  constructor(selector) {\n    this.selector = selector;\n    this.container = document.querySelector(selector);\n    this.github = \"https://raw.githubusercontent.com/rdfinn/genome-properties/master\";\n    window.onhashchange = () => this.loadContent();\n    this.cache = {};\n    this.propertyRenderer = new GenPropRenderer();\n    this.viewerRenderer = new ViewerRenderer(this.github);\n    this.loadContent();\n\n    window.onclick = function(ev){\n      if (location.hash.match(/^#GenProp\\d{4}$/) &&\n          ev.target.localName === \"a\" &&\n          ev.target.parentNode.localName === \"li\" &&\n          ev.target.parentNode.className.indexOf(\"tabs-title\")>-1\n      ){\n        document.querySelectorAll(\"#step-tabs li a\").forEach(e=>e.setAttribute(\"aria-selected\", null));\n        document.querySelectorAll(\"#step-tabs li\").forEach(e=>e.classList.remove(\"is-active\"));\n        ev.target.setAttribute(\"aria-selected\", true);\n        ev.target.parentNode.classList.add(\"is-active\");\n        document.querySelectorAll(\"div[data-tabs-content=step-tabs] .tabs-panel\").forEach(e=>e.classList.remove(\"is-active\"));\n        const target = ev.target.getAttribute(\"target\");\n        document.querySelector(target).classList.add(\"is-active\");\n      } else if (ev.target.localName === \"a\" &&\n        ev.target.parentNode.localName === \"header\" &&\n        ev.target.parentNode.parentNode.localName === \"div\" &&\n        ev.target.parentNode.parentNode.className.indexOf(\"genome-property\")>-1\n      ){\n        const expanded =ev.target.parentNode.parentNode.className.indexOf(\"expanded\") > -1;\n        if (expanded){\n          collapseElement(ev.target);\n        } else {\n          expandElement(ev.target);\n        }\n      } else if (ev.target.localName === \"a\" &&\n        ev.target.className.indexOf(\"expand-all\")>-1\n      ){\n        document.querySelectorAll(\".genome-property a.expander\")\n          .forEach(e => expandElement(e));\n      } else if (ev.target.localName === \"a\" &&\n        ev.target.className.indexOf(\"collapse-all\")>-1\n      ){\n        document.querySelectorAll(\".genome-property a.expander\")\n          .forEach(e => collapseElement(e));\n      }\n    }\n    window.onchange = function(ev){\n      if (ev.target.id==='newfile'){\n\n        const oFiles = document.getElementById(\"newfile\").files;\n        for (let i=0; i < oFiles.length; i++){\n            const reader = new FileReader();\n            reader.fileToRead = oFiles[i];\n            reader.onload = function(evt) {\n              try {\n                  const firstline = evt.target.result.split('\\n')[0];\n                  if (isIpproLine(firstline)){\n                      fetch(gp_server, {\n                          method: 'POST',\n                          body: 'ipprotsv='+evt.target.result,\n                          headers: new Headers({\n                              \"Content-Type\": \"application/x-www-form-urlencoded\",\n                              \"Access-Control-Request-Method\": \"POST\",\n                              \"Access-Control-Request-Headers\": \"X-PINGOTHER, Content-Type\",\n                          })\n                      }).then(response => response.text()).then(\n                          x=> {\n                              viewer.load_genome_properties_text(evt.target.fileToRead.name, x)\n                          }\n                      )\n                  } else {\n                      viewer.load_genome_properties_text(evt.target.fileToRead.name, evt.target.result);\n\n                  }\n              }catch(e){\n                  alert('Bad formatted file');\n                  console.error(e);\n              }\n            };\n            reader.readAsText(oFiles[i]);\n        }\n      }\n    }\n  }\n  markup2html (txt) {\n    const renderer = new RstRenderer(this.github, this);\n    return renderer.markup2html(txt);\n  }\n  loadContent(pageRequiredToChange=false,key=null) {\n    let content = \"\";\n    switch (location.hash) {\n      case \"#home\": case \"\":\n        content = this.getHome();\n        break;\n      case \"#about\":\n      case \"#calculating\":\n      case \"#documentation\":\n      case \"#funding\":\n      case \"#contributing\":\n      case \"#contact\":\n        content = this.getAboutTabs();\n        break;\n      case '#browse':\n      case '#hierarchy':\n      case '#pathways':\n      case '#metapaths':\n      case '#systems':\n      case '#guilds':\n      case '#categories':\n        content = this.getBrowseTabs();\n        break;\n      case \"#viewer\":\n        this.container.innerHTML = this.viewerRenderer.getViewerHTML();\n        this.viewerRenderer.loadViewer();\n        return;\n      default:\n        const propMatch = location.hash.match(/^#GenProp\\d{4}/)\n        if (propMatch){\n          content = this.getGenProp(propMatch[0].substr(1));\n        }else if (pageRequiredToChange){\n            content = \"404: Not found\";\n        }// console.log(\"other\", location.hash);\n    }\n    if (key && key.startsWith(\"INCLUDE_\") && key in this.cache){\n      content = content.replace(key, this.markup2html(this.cache[key]));\n      this.cache[location.hash] = content;\n    }\n    this.container.innerHTML = content;\n    $('.has-tip').foundation();\n\n    let timeoutID =null;\n    $('#genprop-searcher').on('input',function(e){\n      if (timeoutID != null)\n        window.clearTimeout(timeoutID);\n      const term = $(this).val();\n      timeoutID = window.setTimeout(() => searchHierarchy(term), 500);\n    });\n\n  }\n  embbedInSection(html){\n    return `\n    <div class=\"columns\">\n      <section>\n        ${html}\n      </section>\n    </div>\n    `;\n  }\n  getResource(key, url, loader, template_tag=null,embbedInSection=true){\n    if (key in this.cache)\n      return this.cache[key];\n    fetch(url)\n      .then(a=>a.text())\n      .then(a=>{\n        const html = loader(a);\n        this.cache[key] = embbedInSection ? this.embbedInSection(html): html;\n        this.loadContent(true, key);\n      })\n      .catch(a=>console.error(a));\n    return template_tag===null ? this.embbedInSection('loading...') : template_tag;\n  }\n  getGenProp(acc){\n    const url = `${this.github}/data/${acc}/DESC`\n    return this.getResource(acc, url,\n      txt => this.propertyRenderer.renderGenProp(parseGenProp(txt))\n    )\n  }\n  getHome(){\n    // return this.markup2html(text);\n    return this.getResource('#home', `${this.github}/docs/landing.rst?`,this.markup2html.bind(this));\n  }\n  getAboutTabs() {\n    const resource = {\n      \"#about\": '/docs/background.rst',\n      \"#calculating\": '/docs/calculating.rst',\n      \"#documentation\": '/docs/documentation.rst',\n      \"#funding\": '/docs/funding.rst',\n      \"#contributing\": '/docs/contributing.rst',\n      \"#contact\": '/docs/contact.rst',\n    };\n    const tabs = [\n      'About', 'Calculating', 'Funding', 'Contributing', 'Documentation', 'Contact'\n    ];\n    return this.getContentTabs(resource,tabs,this.markup2html.bind(this));\n  }\n  getBrowseTabs() {\n    const resource = {\n      \"#pathways\": '/docs/_stats/stats.PATHWAY',\n      \"#metapaths\": '/docs/_stats/stats.METAPATH',\n      \"#systems\": '/docs/_stats/stats.SYSTEM',\n      \"#guilds\": '/docs/_stats/stats.GUILD',\n      \"#categories\": '/docs/_stats/stats.CATEGORY',\n    };\n\n    const tabs = [\n      'Hierarchy', 'Pathways', 'Metapaths',\n      'Systems', 'Guilds', 'Categories'\n    ];\n    return this.getContentTabs(resource,tabs,this.renderStatsFile);\n  }\n  getContentTabs(resource, tabs, renderer) {\n    return `\n      <ul class=\"tabs\" data-tabs id=\"browse-tabs\">\n      ${tabs.map(tab => {\n        const hash = '#'+tab.toLowerCase();\n        const isActive = hash === location.hash;\n        return `\n          <li class=\"tabs-title ${isActive?'is-active':''}\" >\n            <a ${isActive?'aria-selected=\"true\"':''} href=\"${hash}\">${tab}</a>\n          </li>`;\n        }).join('')\n      }\n      </ul>\n      <br/>\n      ${\n        (location.hash==='#hierarchy' || location.hash==='#browse') ?\n          this.getProps() :\n          this.getResource(\n            location.hash,\n            `${this.github}${resource[location.hash]}`,\n            renderer\n          )\n        }\n    `\n  }\n  renderStatsFile(txt){\n    return `\n    <div id=\"content-browse-tab\">\n      <ul>\n        ${txt.split('\\n').map(line=>{\n          if (line.trim()===\"\") return \"\";\n          const gp =line.split('\\t');\n          return `\n            <li>\n              <a href=\"#${gp[0]}\">${gp[0]}</a>:\n              <a href=\"#${gp[0]}\">${gp[1]}</a>\n            </li>`\n        }).join('')}\n      </ul>\n    </div>`;\n  }\n  getProps(){\n    return this.getResource('props', `${this.github}/flatfiles/hierarchy.json`, txt => {\n      return renderGenPropHierarchyPage(txt)\n    })\n  }\n}\n\nexport default GenomePropertiesWebsite;\n"],"names":["mainKeys","refKeys","stepKeys","parseGenProp","txt","property","currentRef","currentDB","currentStep","currentEV","split","forEach","key","line","substr","value","trim","Number","replace","references","push","title","databases","description","notes","steps","evidence","evidence_list","blockType","RstRenderer","server","manager","converter","showdown","Converter","substitutions","block","obj","lines","parts","length","type","SUBSTITUTION","parts2","INCLUDE","OTHER","i","attr","attributes","slice","join","text","map","indexOf","objBlock","parseBlock","getResource","markup2html","bind","list","ignore","Object","keys","filter","k","newText","replacement","renderHTMLAtrributes","target","onTable","isRow","l","partOfTable","re","addHyperLinks","extractBlocks","applySubstitutions","toMDTables","makeHtml","expandElement","innerHTML","element","parentNode","classList","add","collapseElement","remove","searchHierarchy","querySelectorAll","e","term","document","expandParents","contains","renderGenPropHierarchy","hierarchy","expanded","level","children","id","name","child","renderGenPropHierarchyPage","payload","JSON","parse","GenPropRenderer","isCategory","accession","author","renderDescription","renderReferences","renderChildren","renderSteps","renderDatabaseLink","db","link","acc","ref","number","citation","PMID","step","j","getFirstEvidenceLink","renderEvidence","requires","go","threshold","a","p","gp","t","startsWith","ViewerRenderer","github","d3","gpv","GenomePropertiesViewer","viewer","showTaxonomy","gp_taxonomy","show_tree","select","on","d","c","classed","selectAll","style","transition","update_viewer","gp_server","isIpproLine","uniprot","test","GenomePropertiesWebsite","selector","container","querySelector","onhashchange","loadContent","cache","propertyRenderer","viewerRenderer","onclick","ev","location","hash","match","localName","className","setAttribute","getAttribute","onchange","oFiles","getElementById","files","reader","FileReader","fileToRead","onload","evt","firstline","result","Headers","then","response","load_genome_properties_text","x","error","readAsText","renderer","pageRequiredToChange","content","getHome","getAboutTabs","getBrowseTabs","getViewerHTML","loadViewer","propMatch","getGenProp","foundation","timeoutID","window","clearTimeout","$","val","setTimeout","html","url","loader","template_tag","embbedInSection","catch","console","renderGenProp","resource","tabs","getContentTabs","renderStatsFile","tab","toLowerCase","isActive","getProps"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}