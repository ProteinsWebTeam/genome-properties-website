{"version":3,"file":"gp-website.js","sources":["../src/genprop-parser.js","../src/genprop-hierarchy-parser.js","../src/rst-renderer.js","../src/index.js"],"sourcesContent":["const mainKeys = {\n  AC: 'accession',\n  DE: 'name',\n  TP: 'type',\n  TH: 'threshold',\n};\nconst refKeys = {\n  RM:\t'PMID',\n  RT:\t'title',\n  RA:\t'author',\n  RL:\t'citation',\n}\nconst stepKeys = {\n  ID:\t'id',\n  DN:\t'name',\n  RQ:\t'requires',\n}\nconst parseGenProp = (txt) => {\n  const property = {\n    references: [],\n    databases: [],\n    steps: [],\n    description: '',\n    notes: '',\n  };\n  let currentRef = null;\n  let currentDB = null;\n  let currentStep = null;\n  let currentEV = null;\n  txt.split('\\n').forEach(line=>{\n    const key = line.substr(0,2);\n    const value = line.substr(3).trim();\n    if (key in mainKeys) property[mainKeys[key]] = value;\n\n    // References\n    if (key === 'RN') {\n      currentRef = {number: Number(value.replace('[','').replace(']',''))}\n      property.references.push(currentRef);\n    }\n    if (key in refKeys && currentRef) currentRef[refKeys[key]] = value;\n\n    // Databases\n    if (key === 'DC') {\n      currentDB = {title: value}\n      property.databases.push(currentDB);\n    }\n    if (key === 'DR' && currentDB) currentDB['link'] = value;\n\n    // Description\n    if (key === 'CC') property.description += value + ' ';\n\n    // Notes\n    if (key === '**') property.notes += value + ' ';\n\n    // Steps\n    if (key === 'SN') {\n      currentStep = {\n        number: Number(value),\n        evidence_list: [],\n      }\n      property.steps.push(currentStep);\n    }\n    if (key in stepKeys && currentStep) currentStep[stepKeys[key]] = value;\n    // Evidence\n    if (key === 'EV' && currentStep) {\n      currentEV = {evidence: value}\n      currentStep.evidence_list.push(currentEV);\n    }\n    if (key === 'TG' && currentStep && currentEV) currentEV['go'] = value;\n\n  });\n  return property;\n  // console.log(property);\n  // return `<pre>${JSON.stringify(property, null, '  ')}</pre>`;\n};\n\n\nexport default parseGenProp;\n","const parseGenPropHierarchy = (txt) => {\n  const ignore = ['GenProp0068']\n  const hierarchy = {};\n  txt.split('\\n').forEach(line => {\n    const parts = line.split('\\t');\n    if (parts[0].trim() !== '' &&\n        ignore.indexOf(parts[0])==-1 &&\n        ignore.indexOf(parts[2])==-1\n    ) {\n      if (!(parts[0] in hierarchy))\n        hierarchy[parts[0]] = {\n          id: parts[0],\n          name: parts[1],\n          // parents: [],\n          children: [],\n        }\n      if (!(parts[2] in hierarchy))\n        hierarchy[parts[2]] = {\n          id: parts[2],\n          name: parts[3],\n          // parents: [],\n          children: [],\n      }\n      hierarchy[parts[0]].children.push(hierarchy[parts[2]])\n    }\n  });\n  return hierarchy;\n}\n\nexport default parseGenPropHierarchy;\n","import showdown from \"showdown\";\n\nconst blockType = {\n  SUBSTITUTION: 1,\n  OTHER:-1,\n}\n\nexport class RstRenderer {\n  constructor(server){\n    this.converter = new showdown.Converter();\n    this.server = server;\n    this.substitutions = {};\n  }\n\n  parseBlock(block){\n    const obj = {};\n    const lines = block.split('\\n');\n    const parts  = lines[0].split('|');\n    if (parts.length==3 && parts[0].trim()==='..'){\n      obj.type = blockType.SUBSTITUTION;\n      obj.key = parts[1];\n      const value = parts[2].split('::');\n      obj.value = {\n        type: value[0].trim(),\n        value: value[1].trim(),\n        attributes: {}\n      }\n    } else {\n      obj.type = blockType.OTHER;\n      obj.value = lines[0].substr(3);\n    }\n    for (let i=1;i<lines.length;i++){\n      if (obj.type === blockType.SUBSTITUTION){\n        const attr = lines[i].split(':');\n        if (attr.length > 2 && attr[1].trim() !== \"\"){\n          obj.value.attributes[attr[1]] = attr.slice(2).join(':');\n        }\n      } else {\n        obj.value += lines[i].trim()\n      }\n    }\n    return obj;\n  }\n\n  extractBlocks(txt){\n    let block = '';\n    let text = txt.split('\\n').map(line => {\n      if (line.indexOf('..')===0) {\n        block += line+'\\n';\n        return '';\n      }\n      if (block !== ''){\n        if (line.indexOf('  ')===0 && line.trim()!==''){\n          block += line+'\\n';\n          return '';\n        }else{\n          const objBlock = this.parseBlock(block);\n          if (objBlock.type === blockType.SUBSTITUTION){\n            this.substitutions[objBlock.key] = objBlock;\n          }\n          block='';\n        }\n      }\n      return line;\n    }).join('\\n');\n\n    return text;\n  }\n\n  applySubstitutions(txt) {\n    let newText = txt;\n    for (const key in this.substitutions){\n      const value = this.substitutions[key].value;\n      let replacement = '';\n      if (value.type==\"image\"){\n        replacement = `<img src=\"${this.server}/docs/${value.value}\" ${\n          Object.keys(value.attributes)\n            .map(k=>k+`=\"${value.attributes[k]}\"`)\n            .join(\"\")\n        }/>`\n      } else {\n        replacement = value.value;\n      }\n      console.log(`|${key}|`,replacement);\n      newText = newText.replace(`|${key}|`,replacement);\n    }\n    return newText;\n  }\n  toMDTables(txt) {\n    let onTable = false;\n    return txt.split('\\n').map(l=>{\n      const isRow = l.indexOf('+--')===0;\n      const partOfTable = l.indexOf('|')===0;\n      if (!onTable && isRow){\n        onTable=true;\n        return '<table>';\n      }\n      if (onTable && isRow) return '';\n      if (onTable && !isRow && partOfTable){\n        return '<tr><td>'+l.split('|').slice(1,-1).join('</td><td>')+'</td></tr>'\n      }\n      if (onTable && !isRow && !partOfTable){\n        onTable = false;\n        return '</table>';\n      }\n      return l;\n    }).join('\\n');\n  }\n  markup2html (txt) {\n    let text = txt\n      .replace(\"[BUTTON_BROWSE]\", '<a href=\"#browse\" class=\"button\">Browse</a>')\n      .replace(\"[BUTTON_VIEWER]\", '<a href=\"#viewer\" class=\"button\">Viewer</a>');\n    text = this.extractBlocks(text)\n    text = this.applySubstitutions(text);\n    text = this.toMDTables(text)\n    return '<br/>'+this.converter.makeHtml(text);\n  }\n\n}\n","import parseGenProp from \"./genprop-parser\";\nimport parseGenPropHierarchy from \"./genprop-hierarchy-parser\";\nimport {RstRenderer} from \"./rst-renderer\";\n\nclass GenomePropertiesWebsite {\n  constructor(selector) {\n    this.selector = selector;\n    this.container = document.querySelector(selector);\n    this.github = \"https://raw.githubusercontent.com/rdfinn/genome-properties/master\";\n    window.onhashchange = () => this.loadContent();\n    this.cache = {};\n    this.loadContent();\n    window.onclick = function(ev){\n      if (location.hash.match(/^#GenProp\\d{4}$/) &&\n          ev.target.localName === \"a\" &&\n          ev.target.parentNode.localName === \"li\" &&\n          ev.target.parentNode.className.indexOf(\"tabs-title\")>-1\n      ){\n        document.querySelectorAll(\"#step-tabs li a\").forEach(e=>e.setAttribute(\"aria-selected\", null));\n        document.querySelectorAll(\"#step-tabs li\").forEach(e=>e.classList.remove(\"is-active\"));\n        ev.target.setAttribute(\"aria-selected\", true);\n        ev.target.parentNode.classList.add(\"is-active\");\n        document.querySelectorAll(\"div[data-tabs-content=step-tabs] .tabs-panel\").forEach(e=>e.classList.remove(\"is-active\"));\n        const target = ev.target.getAttribute(\"target\");\n        document.querySelector(target).classList.add(\"is-active\");\n      } else if (ev.target.localName === \"a\" &&\n        ev.target.parentNode.localName === \"header\" &&\n        ev.target.parentNode.parentNode.localName === \"div\" &&\n        ev.target.parentNode.parentNode.className.indexOf(\"genome-property\")>-1\n      ){\n        const expanded =ev.target.parentNode.parentNode.className.indexOf(\"expanded\") > -1;\n        if (expanded){\n          ev.target.innerHTML = '▸';\n          ev.target.parentNode.parentNode.classList.remove(\"expanded\");\n        } else {\n          ev.target.innerHTML = '▾';\n          ev.target.parentNode.parentNode.classList.add(\"expanded\");\n        }\n      }\n    }\n    window.onchange = function(ev){\n      console.log(ev.target.id);\n      if (ev.target.id==='newfile'){\n\n        const oFiles = document.getElementById(\"newfile\").files;\n        for (let i=0; i < oFiles.length; i++){\n            const reader = new FileReader();\n            reader.fileToRead = oFiles[i];\n            reader.onload = function(evt) {\n              try {\n                viewer.load_genome_properties_text(evt.target.fileToRead.name, evt.target.result);\n              }catch(e){\n                  alert('Bad formatted file');\n                  console.error(e);\n              }\n            };\n            reader.readAsText(oFiles[i]);\n        }\n      }\n    }\n  }\n  markup2html (txt) {\n    const renderer = new RstRenderer(this.github);\n    return renderer.markup2html(txt);\n  }\n  loadContent(pageRequiredToChange=false) {\n    const resource = {\n      \"#about\": '/docs/background.rst',\n      \"#calculating\": '/docs/calculating.rst',\n      \"#docs\": '/docs/index.rst',\n      \"#funding\": '/docs/funding.rst',\n      \"#contributing\": 'docs/contributing.rst',\n      \"#contact\": 'docs/contact.rst',\n    };\n    switch (location.hash) {\n      case \"#home\": case \"\":\n        this.container.innerHTML = this.getHome();\n        break;\n      case \"#about\":\n      case \"#calculating\":\n      case \"#docs\":\n      case \"#funding\":\n      case \"#contributing\":\n      case \"#contact\":\n        this.container.innerHTML = this.getFromGithubAndMarkup2HTML(resource[location.hash]);\n        break;\n      case '#browse':\n      case '#hierarchy':\n      case '#pathways':\n      case '#metapaths':\n      case '#systems':\n      case '#guilds':\n      case '#categories':\n        this.container.innerHTML = this.getBrowseTabs();\n        break;\n      case \"#viewer\":\n        this.container.innerHTML = this.getViewerHTML();\n        var d3 = gpv.d3,\n                GenomePropertiesViewer = gpv.GenomePropertiesViewer,\n                viewer = new GenomePropertiesViewer({\n                    element_selector: \"#gp-viewer\",\n                    controller_element_selector: \"#gp-selector\",\n                    server: \"http://www.ebi.ac.uk/~gsalazar/genome_property.php?org=\",\n                    hierarchy_path: \"./files/gp.dag.txt\",\n                    whitelist_path: \"https://raw.githubusercontent.com/ProteinsWebTeam/genome-properties-viewer/master/test-files/gp_white_list.json\",\n                    server_tax: \"./files/taxonomy.json\",\n                    height: 700\n                });\n          window.viewer = viewer;\n          d3.select(\".minimise\").on(\"click\",(d,i,c)=>{\n              const on = d3.select(c[i]).classed(\"on\");\n              d3.selectAll(\".top-controllers>div\")\n                      .style(\"max-height\", on?\"0px\":\"500px\")\n                      .style(\"overflow\", on?null:\"hidden\")\n                      .transition(200)\n                      .style(\"max-height\", on?\"500px\":\"0px\")\n                      .style(\"opacity\", on?1:0);\n              d3.selectAll(\".top-controllers\").transition(200).style(\"padding\", on?\"5px\":\"0px\");\n              d3.select(c[i]).classed(\"on\", !on);\n          });\n        break;\n      default:\n        if (location.hash.match(/^#GenProp\\d{4}$/)){\n          this.container.innerHTML = this.getGenProp(location.hash.substr(1));\n          return;\n        }\n        if (pageRequiredToChange)\n          this.container.innerHTML = \"404: Not found\";\n        // console.log(\"other\", location.hash);\n    }\n  }\n  embbedInSection(html){\n    return `\n    <div class=\"columns\">\n      <section>\n        ${html}\n      </section>\n    </div>\n    `;\n\n  }\n  getResource(key, url, loader){\n    if (key in this.cache)\n      return this.cache[key];\n    fetch(url)\n      .then(a=>a.text())\n      .then(a=>{\n        const html = loader(a);\n        this.cache[key] = this.embbedInSection(html);\n        this.loadContent(true);\n      })\n      .catch(a=>console.error(a));\n\n    return this.embbedInSection('loading...');\n  }\n  renderGenProp(property){\n    return `\n    <h2>${property.accession}</h2>\n      <h3>${property.name}</h3>\n      <span class=\"tag\">${property.type}</span> <span class=\"tag secondary\">Threshold: ${property.threshold}</span>\n      <br/><br/>\n      <div class=\"row\">\n        <h4>Description</h4>\n        <p>${this.renderDescription(property.description, property.accession)}</p>\n      </div>\n      <div class=\"row\">\n        <h4>Steps</h4>\n        <div class=\"medium-3 columns\">\n          <ul class=\"vertical tabs\" data-tabs id=\"step-tabs\">\n            ${property.steps.map((step,i) => `\n              <li class=\"tabs-title ${i===0?'is-active':''}\">\n                <a target=\"#panel${step.number}\" ${i===0?'aria-selected=\"true\"':''}>\n                  ${step.number}. ${step.id}\n                </a>\n              </li>\n            `).join('')}\n          </ul>\n        </div>\n        <div class=\"medium-9 columns\">\n          <div class=\"tabs-content\" data-tabs-content=\"step-tabs\">\n          ${property.steps.map((step,i) => `\n            <div class=\"tabs-panel ${i===0?'is-active':''}\" id=\"panel${step.number}\">\n              <h5>${step.id}</h5>\n              ${step.requires===\"1\"?'<span class=\"tag\">Required</span>':''}\n              <table>\n                <tr>\n                  <th>Evidence</th>\n                  <th>Go Terms</th>\n                </tr>\n                ${step.evidence_list.map((e,i) => `\n                  <tr>\n                    <td>${this.renderEvidence(e.evidence)}</td>\n                    <td>${this.renderEvidence(e.go)}</td>\n                  </tr>\n                `).join('')}\n              </table>\n            </div>\n          `).join('')}\n          </div>\n        </div>\n      </div>\n      <div class=\"row\">\n        <h4>Database Links</h4>\n        <ul>\n          ${property.databases.map(db => `\n            <li>${this.renderDatabaseLink(db.title, db.link)}</li>\n          `).join('')}\n        </ul>\n      </div>\n      <div class=\"row\">\n        <h4>References</h4>\n        <ul class=\"references\">\n          ${property.references.map(ref => `\n              <li class=\"reference\" id=\"${property.accession}-${ref.number}\">\n                <span class=\"index\">[${ref.number}]</span>\n                <span class=\"authors\">${ref.author}</span>\n                <span class=\"title\">${ref.title}</span>\n                <span class=\"citation\">${ref.citation}</span>\n                <span class=\"reference_id\">${ref.PMID}</span>\n                <a target=\"_blank\" rel=\"noopener\" href=\"https://europepmc.org/abstract/MED/${ref.PMID}\">EuropePMC</a>\n              </li>\n          `).join('')}\n        </ul>\n      </div>\n\n    `;\n  }\n  renderDescription(txt, acc){\n    return txt.replace(/\\[(\\d+)\\]/g, `<a href=\"#${acc}-$1\">[$1]</a>`);\n  }\n  renderDatabaseLink(title, link){\n    let a = link;\n    const parts = link.split(';').map(p => p.trim());\n    if (parts[0] === 'KEGG')\n      a = `<a\n        href=\"http://www.genome.jp/dbget-bin/www_bget?pathway:${parts[1]}\"\n      >KEGG</a>`;\n    else if (parts[0] === 'IUBMB')\n      a = `<a\n        href=\"http://www.chem.qmul.ac.uk/iubmb/enzyme/reaction/${parts[1]}/${parts[2]}.html\"\n      >IUBMB</a>`\n    else if (parts[0] === 'MetaCyc')\n      a = `<a\n        href=\"https://metacyc.org/META/NEW-IMAGE?type=NIL&object=${parts[1]}\"\n      >MetaCyc</a>`\n    return `<b>${title}</b>: ${a}`;\n  }\n  renderEvidence(txt){\n    if (!txt) return '';\n    const parts = txt.split(';');\n    return parts\n      .filter(p => p.trim()!=='')\n      .map(t => {\n        const term = t.trim();\n        if (term.startsWith(\"GO:\"))\n          return `<a href=\"http://www.ebi.ac.uk/QuickGO/GTerm?id=${term}\">${term}</a>`\n        if (term.startsWith(\"GenProp\"))\n          return `<a href=\"#${term}\">${term}</a>`\n        if (term.startsWith(\"IPR\"))\n          return `<a href=\"https://www.ebi.ac.uk/interpro/entry/${term}\">${term}</a>`\n        if (term.startsWith(\"TIGR\"))\n          return `<a href=\"http://www.jcvi.org/cgi-bin/tigrfams/HmmReportPage.cgi?acc=${term}\">${term}</a>`\n        else {\n          return term;\n        }\n      }).join(' - ')\n  }\n  renderGenPropHierarchy(hierarchy, expanded=true, level=1){\n    // console.log(hierarchy)\n    return `\n    <div class=\"genome-property ${expanded?'expanded':''}\">\n      <header>\n        ${!hierarchy.children.length?'・':`\n        <a style=\"border: 0;color: darkred;\">${expanded?'▾':'▸'}</a>\n        `}\n        <a href=\"#${hierarchy.id}\">${hierarchy.id}</a>: ${hierarchy.name}\n      </header>\n      ${!hierarchy.children.length?'':`\n        <div class=\"children\" style=\"\n          margin-left: ${level*10}px;\n        \">\n          ${hierarchy.children\n            .map(child => this.renderGenPropHierarchy(child, false, level+1))\n            .join('')}\n        </div>\n      `}\n    </div>\n    `;\n  }\n  getViewerHTML() {\n    return `\n      <div class=\"container\">\n        <div class=\"top-block\">\n            <div id=\"gp-controllers\" class=\"top-controllers\">\n                <div>\n                    <header>Taxonomy Options</header>\n                    <ul>\n                        <li><label for=\"tax-search\">Search:</label>\n                            <input type=\"text\" id=\"tax-search\">\n                        </li>\n                        <li>\n                            <label for=\"newfile\">Upload File: </label>\n                            <input type=\"file\" id=\"newfile\"/>\n                        </li>\n                        <li><label for=\"tax_label\">Labels:</label>\n                            <select id=\"tax_label\">\n                                <option value=\"name\">Species</option>\n                                <option value=\"id\">Tax ID</option>\n                                <option value=\"both\">Both</option>\n                            </select>\n                        </li>\n\n                    </ul>\n                </div>\n                <div>\n                    <header>Genome Properties Options</header>\n                    <ul>\n                        <li><label for=\"gp-selector\">Top level category:</label>\n                            <div id=\"gp-selector\" class=\"selector\"></div>\n                        </li>\n                        <li><label for=\"gp-filter\">Filter:</label>\n                            <input type=\"text\" id=\"gp-filter\">\n                        </li>\n                        <li><label for=\"gp_label\">Label:</label>\n                            <select id=\"gp_label\">\n                                <option value=\"name\">Name</option>\n                                <option value=\"id\">ID</option>\n                                <option value=\"both\">Both</option>\n                            </select>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"gp-legends\">\n                    <header>Legends</header>\n                </div>\n                <a class=\"minimise\"></a>\n            </div>\n        </div>\n        <div id=\"gp-viewer\"></div>\n        <div class=\"info-tooltip\"></div>\n    </div>`\n  }\n  getGenProp(acc){\n    const url = `${this.github}/data/${acc}/DESC`\n    return this.getResource(acc, url, txt => this.renderGenProp(parseGenProp(txt)))\n  }\n  getHome(){\n    return this.getResource('home', `${this.github}/docs/landing.rst`,this.markup2html.bind(this));\n  }\n  getFromGithubAndMarkup2HTML(path){\n    return this.getResource(path, `${this.github}${path}`, this.markup2html.bind(this))\n  }\n  getBrowseTabs() {\n    const resource = {\n      \"#pathways\": '/docs/_stats/stats.PATHWAY',\n      \"#metapaths\": '/docs/_stats/stats.METAPATH',\n      \"#systems\": '/docs/_stats/stats.SYSTEM',\n      \"#guilds\": '/docs/_stats/stats.GUILD',\n      \"#categories\": '/docs/_stats/stats.CATEGORY',\n    };\n\n    const tabs = [\n      'Hierarchy', 'Pathways', 'Metapaths',\n      'Systems', 'Guilds', 'Categories'\n    ];\n    return `\n      <ul class=\"tabs\" data-tabs id=\"browse-tabs\">\n      ${tabs.map(tab => {\n        const hash = '#'+tab.toLowerCase();\n        const isActive = hash === location.hash;\n        return `\n          <li class=\"tabs-title ${isActive?'is-active':''}\" >\n            <a ${isActive?'aria-selected=\"true\"':''} href=\"${hash}\">${tab}</a>\n          </li>`;\n        }).join('')\n      }\n      </ul>\n      <br/>\n      ${\n        (location.hash==='#hierarchy' || location.hash==='#browse') ?\n          this.getProps() :\n          this.getResource(\n            location.hash,\n            `${this.github}${resource[location.hash]}`,\n            this.renderStatsFile\n          )\n        }\n    `\n  }\n  renderStatsFile(txt){\n    return `\n    <div id=\"content-browse-tab\">\n      <ul>\n        ${txt.split('\\n').map(line=>{\n          if (line.trim()===\"\") return \"\";\n          const gp =line.split('\\t');\n          return `\n            <li>\n              <a href=\"#${gp[0]}\">${gp[0]}</a>: ${gp[1]}\n            </li>`\n        }).join('')}\n      </ul>\n    </div>`;\n  }\n  getProps(){\n    return this.getResource('props', 'files/gp.dag2.txt', txt => {\n      return this.renderGenPropHierarchy(parseGenPropHierarchy(txt)['GenProp0065'])\n      // return `<pre>${JSON.stringify(parseGenPropHierarchy(txt)['GenProp0065'], null, ' ')}</pre>`;\n    })\n  }\n}\n\nexport default GenomePropertiesWebsite;\n"],"names":["mainKeys","refKeys","stepKeys","parseGenProp","txt","property","currentRef","currentDB","currentStep","currentEV","split","forEach","key","line","substr","value","trim","number","Number","replace","references","push","title","databases","description","notes","steps","evidence","evidence_list","parseGenPropHierarchy","ignore","hierarchy","parts","indexOf","children","blockType","RstRenderer","server","converter","showdown","Converter","substitutions","block","obj","lines","length","type","SUBSTITUTION","OTHER","i","attr","attributes","slice","join","text","map","objBlock","parseBlock","newText","replacement","Object","keys","k","log","onTable","isRow","l","partOfTable","extractBlocks","applySubstitutions","toMDTables","makeHtml","GenomePropertiesWebsite","selector","container","document","querySelector","github","onhashchange","loadContent","cache","onclick","ev","location","hash","match","target","localName","parentNode","className","querySelectorAll","e","setAttribute","classList","remove","add","getAttribute","expanded","innerHTML","onchange","id","oFiles","getElementById","files","reader","FileReader","fileToRead","onload","evt","load_genome_properties_text","name","result","error","readAsText","renderer","markup2html","pageRequiredToChange","resource","getHome","getFromGithubAndMarkup2HTML","getBrowseTabs","getViewerHTML","d3","gpv","GenomePropertiesViewer","viewer","select","on","d","c","classed","selectAll","style","transition","getGenProp","html","url","loader","then","a","embbedInSection","catch","console","accession","threshold","renderDescription","step","requires","renderEvidence","go","renderDatabaseLink","db","link","ref","author","citation","PMID","acc","p","filter","term","t","startsWith","level","renderGenPropHierarchy","child","getResource","renderGenProp","bind","path","tabs","tab","toLowerCase","isActive","getProps","renderStatsFile","gp"],"mappings":";;;AAAA,IAAMA,WAAW;MACX,WADW;MAEX,MAFW;MAGX,MAHW;MAIX;CAJN;AAMA,IAAMC,UAAU;MACV,MADU;MAEV,OAFU;MAGV,QAHU;MAIV;CAJN;AAMA,IAAMC,WAAW;MACX,IADW;MAEX,MAFW;MAGX;CAHN;AAKA,IAAMC,eAAe,SAAfA,YAAe,CAACC,GAAD,EAAS;MACtBC,WAAW;gBACH,EADG;eAEJ,EAFI;WAGR,EAHQ;iBAIF,EAJE;WAKR;GALT;MAOIC,aAAa,IAAjB;MACIC,YAAY,IAAhB;MACIC,cAAc,IAAlB;MACIC,YAAY,IAAhB;MACIC,KAAJ,CAAU,IAAV,EAAgBC,OAAhB,CAAwB,gBAAM;QACtBC,MAAMC,KAAKC,MAAL,CAAY,CAAZ,EAAc,CAAd,CAAZ;QACMC,QAAQF,KAAKC,MAAL,CAAY,CAAZ,EAAeE,IAAf,EAAd;QACIJ,OAAOZ,QAAX,EAAqBK,SAASL,SAASY,GAAT,CAAT,IAA0BG,KAA1B;;;QAGjBH,QAAQ,IAAZ,EAAkB;mBACH,EAACK,QAAQC,OAAOH,MAAMI,OAAN,CAAc,GAAd,EAAkB,EAAlB,EAAsBA,OAAtB,CAA8B,GAA9B,EAAkC,EAAlC,CAAP,CAAT,EAAb;eACSC,UAAT,CAAoBC,IAApB,CAAyBf,UAAzB;;QAEEM,OAAOX,OAAP,IAAkBK,UAAtB,EAAkCA,WAAWL,QAAQW,GAAR,CAAX,IAA2BG,KAA3B;;;QAG9BH,QAAQ,IAAZ,EAAkB;kBACJ,EAACU,OAAOP,KAAR,EAAZ;eACSQ,SAAT,CAAmBF,IAAnB,CAAwBd,SAAxB;;QAEEK,QAAQ,IAAR,IAAgBL,SAApB,EAA+BA,UAAU,MAAV,IAAoBQ,KAApB;;;QAG3BH,QAAQ,IAAZ,EAAkBP,SAASmB,WAAT,IAAwBT,QAAQ,GAAhC;;;QAGdH,QAAQ,IAAZ,EAAkBP,SAASoB,KAAT,IAAkBV,QAAQ,GAA1B;;;QAGdH,QAAQ,IAAZ,EAAkB;oBACF;gBACJM,OAAOH,KAAP,CADI;uBAEG;OAFjB;eAISW,KAAT,CAAeL,IAAf,CAAoBb,WAApB;;QAEEI,OAAOV,QAAP,IAAmBM,WAAvB,EAAoCA,YAAYN,SAASU,GAAT,CAAZ,IAA6BG,KAA7B;;QAEhCH,QAAQ,IAAR,IAAgBJ,WAApB,EAAiC;kBACnB,EAACmB,UAAUZ,KAAX,EAAZ;kBACYa,aAAZ,CAA0BP,IAA1B,CAA+BZ,SAA/B;;QAEEG,QAAQ,IAAR,IAAgBJ,WAAhB,IAA+BC,SAAnC,EAA8CA,UAAU,IAAV,IAAkBM,KAAlB;GAvChD;SA0COV,QAAP;;;CAtDF,CA4DA;;AC7EA,IAAMwB,wBAAwB,SAAxBA,qBAAwB,CAACzB,GAAD,EAAS;MAC/B0B,SAAS,CAAC,aAAD,CAAf;MACMC,YAAY,EAAlB;MACIrB,KAAJ,CAAU,IAAV,EAAgBC,OAAhB,CAAwB,gBAAQ;QACxBqB,QAAQnB,KAAKH,KAAL,CAAW,IAAX,CAAd;QACIsB,MAAM,CAAN,EAAShB,IAAT,OAAoB,EAApB,IACAc,OAAOG,OAAP,CAAeD,MAAM,CAAN,CAAf,KAA0B,CAAC,CAD3B,IAEAF,OAAOG,OAAP,CAAeD,MAAM,CAAN,CAAf,KAA0B,CAAC,CAF/B,EAGE;UACI,EAAEA,MAAM,CAAN,KAAYD,SAAd,CAAJ,EACEA,UAAUC,MAAM,CAAN,CAAV,IAAsB;YAChBA,MAAM,CAAN,CADgB;cAEdA,MAAM,CAAN,CAFc;;kBAIV;OAJZ;UAME,EAAEA,MAAM,CAAN,KAAYD,SAAd,CAAJ,EACEA,UAAUC,MAAM,CAAN,CAAV,IAAsB;YAChBA,MAAM,CAAN,CADgB;cAEdA,MAAM,CAAN,CAFc;;kBAIV;OAJZ;gBAMQA,MAAM,CAAN,CAAV,EAAoBE,QAApB,CAA6Bb,IAA7B,CAAkCU,UAAUC,MAAM,CAAN,CAAV,CAAlC;;GApBJ;SAuBOD,SAAP;CA1BF,CA6BA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}