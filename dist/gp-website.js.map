{"version":3,"file":"gp-website.js","sources":["../src/genprop-parser.js","../src/genprop-hierarchy-parser.js","../src/index.js"],"sourcesContent":["const mainKeys = {\n  AC: 'accession',\n  DE: 'name',\n  TP: 'type',\n  TH: 'threshold',\n};\nconst refKeys = {\n  RM:\t'PMID',\n  RT:\t'title',\n  RA:\t'author',\n  RL:\t'citation',\n}\nconst stepKeys = {\n  ID:\t'id',\n  DN:\t'name',\n  RQ:\t'requires',\n}\nconst parseGenProp = (txt) => {\n  const property = {\n    references: [],\n    databases: [],\n    steps: [],\n    description: '',\n    notes: '',\n  };\n  let currentRef = null;\n  let currentDB = null;\n  let currentStep = null;\n  let currentEV = null;\n  txt.split('\\n').forEach(line=>{\n    const key = line.substr(0,2);\n    const value = line.substr(3).trim();\n    if (key in mainKeys) property[mainKeys[key]] = value;\n\n    // References\n    if (key === 'RN') {\n      currentRef = {number: Number(value.replace('[','').replace(']',''))}\n      property.references.push(currentRef);\n    }\n    if (key in refKeys && currentRef) currentRef[refKeys[key]] = value;\n\n    // Databases\n    if (key === 'DC') {\n      currentDB = {title: value}\n      property.databases.push(currentDB);\n    }\n    if (key === 'DR' && currentDB) currentDB['link'] = value;\n\n    // Description\n    if (key === 'CC') property.description += value + ' ';\n\n    // Notes\n    if (key === '**') property.notes += value + ' ';\n\n    // Steps\n    if (key === 'SN') {\n      currentStep = {\n        number: Number(value),\n        evidence_list: [],\n      }\n      property.steps.push(currentStep);\n    }\n    if (key in stepKeys && currentStep) currentStep[stepKeys[key]] = value;\n    // Evidence\n    if (key === 'EV' && currentStep) {\n      currentEV = {evidence: value}\n      currentStep.evidence_list.push(currentEV);\n    }\n    if (key === 'TG' && currentStep && currentEV) currentEV['go'] = value;\n\n  });\n  return property;\n  // console.log(property);\n  // return `<pre>${JSON.stringify(property, null, '  ')}</pre>`;\n};\n\n\nexport default parseGenProp;\n","const parseGenPropHierarchy = (txt) => {\n  const ignore = ['GenProp0068']\n  const hierarchy = {};\n  txt.split('\\n').forEach(line => {\n    const parts = line.split('\\t');\n    if (parts[0].trim() !== '' &&\n        ignore.indexOf(parts[0])==-1 &&\n        ignore.indexOf(parts[2])==-1\n    ) {\n      if (!(parts[0] in hierarchy))\n        hierarchy[parts[0]] = {\n          id: parts[0],\n          name: parts[1],\n          // parents: [],\n          children: [],\n        }\n      if (!(parts[2] in hierarchy))\n        hierarchy[parts[2]] = {\n          id: parts[2],\n          name: parts[3],\n          // parents: [],\n          children: [],\n      }\n      hierarchy[parts[0]].children.push(hierarchy[parts[2]])\n    }\n  });\n  return hierarchy;\n}\n\nexport default parseGenPropHierarchy;\n","import showdown from \"showdown\";\nimport parseGenProp from \"./genprop-parser\";\nimport parseGenPropHierarchy from \"./genprop-hierarchy-parser\";\n\nclass GenomePropertiesWebsite {\n  constructor(selector) {\n    this.selector = selector;\n    this.container = document.querySelector(selector);\n    window.onhashchange = () => this.loadContent();\n    this.cache = {};\n    this.loadContent();\n    window.onclick = function(ev){\n      if (ev.target.localName === \"a\" &&\n          ev.target.parentNode.localName === \"li\" &&\n          ev.target.parentNode.className.indexOf(\"tabs-title\")>-1\n      ){\n        document.querySelectorAll(\"#step-tabs li a\").forEach(e=>e.setAttribute(\"aria-selected\", null));\n        document.querySelectorAll(\"#step-tabs li\").forEach(e=>e.classList.remove(\"is-active\"));\n        ev.target.setAttribute(\"aria-selected\", true);\n        ev.target.parentNode.classList.add(\"is-active\");\n        document.querySelectorAll(\"div[data-tabs-content=step-tabs] .tabs-panel\").forEach(e=>e.classList.remove(\"is-active\"));\n        const target = ev.target.getAttribute(\"target\");\n        document.querySelector(target).classList.add(\"is-active\");\n      } else if (ev.target.localName === \"a\" &&\n        ev.target.parentNode.localName === \"header\" &&\n        ev.target.parentNode.parentNode.localName === \"div\" &&\n        ev.target.parentNode.parentNode.className.indexOf(\"genome-property\")>-1\n      ){\n        const expanded =ev.target.parentNode.parentNode.className.indexOf(\"expanded\") > -1;\n        if (expanded){\n          ev.target.innerHTML = '▸';\n          ev.target.parentNode.parentNode.classList.remove(\"expanded\");\n        } else {\n          ev.target.innerHTML = '▾';\n          ev.target.parentNode.parentNode.classList.add(\"expanded\");\n        }\n      }\n    }\n    window.onchange = function(ev){\n      console.log(ev.target.id);\n      if (ev.target.id==='newfile'){\n\n        const oFiles = document.getElementById(\"newfile\").files;\n        for (let i=0; i < oFiles.length; i++){\n            const reader = new FileReader();\n            reader.fileToRead = oFiles[i];\n            reader.onload = function(evt) {\n                viewer.load_genome_properties_text(evt.target.fileToRead.name, evt.target.result);\n            };\n            reader.readAsText(oFiles[i]);\n        }\n      }\n    }\n  }\n  loadContent(pageRequiredToChange=false) {\n    switch (location.hash) {\n      case \"#home\": case \"\":\n        this.container.innerHTML = this.getHome();\n        break;\n      case \"#docs\":\n        this.container.innerHTML = this.getDocs();\n        break;\n      case \"#properties\":\n        this.container.innerHTML = this.getProps();\n        break;\n      case \"#viewer\":\n        this.container.innerHTML = this.getViewerHTML();\n        var d3 = gpv.d3,\n                GenomePropertiesViewer = gpv.GenomePropertiesViewer,\n                viewer = new GenomePropertiesViewer({\n                    element_selector: \"#gp-viewer\",\n                    controller_element_selector: \"#gp-selector\",\n                    server: \"http://www.ebi.ac.uk/~gsalazar/genome_property.php?org=\",\n                    hierarchy_path: \"./files/gp.dag.txt\",\n                    whitelist_path: \"https://raw.githubusercontent.com/ProteinsWebTeam/genome-properties-viewer/master/test-files/gp_white_list.json\",\n                    server_tax: \"./files/taxonomy.json\",\n                    height: 700\n                });\n          window.viewer = viewer;\n          d3.select(\".minimise\").on(\"click\",(d,i,c)=>{\n              const on = d3.select(c[i]).classed(\"on\");\n              d3.selectAll(\".top-controllers>div\")\n                      .style(\"max-height\", on?\"0px\":\"500px\")\n                      .style(\"overflow\", on?null:\"hidden\")\n                      .transition(200)\n                      .style(\"max-height\", on?\"500px\":\"0px\")\n                      .style(\"opacity\", on?1:0);\n              d3.selectAll(\".top-controllers\").transition(200).style(\"padding\", on?\"5px\":\"0px\");\n              d3.select(c[i]).classed(\"on\", !on);\n          });\n        break;\n      default:\n        if (location.hash.match(/^#GenProp\\d{4}$/)){\n          this.container.innerHTML = this.getGenProp(location.hash.substr(1));\n          return;\n        }\n        if (pageRequiredToChange)\n          this.container.innerHTML = \"404: Not found\";\n        // console.log(\"other\", location.hash);\n    }\n  }\n  embbedInSection(html){\n    return `\n    <div class=\"columns\">\n      <section>\n        ${html}\n      </section>\n    </div>\n    `;\n\n  }\n  markup2html(txt, key) {\n    const converter = new showdown.Converter();\n    return converter.makeHtml(txt);\n  }\n  getResource(key, url, loader){\n    if (key in this.cache)\n      return this.cache[key];\n    fetch(url)\n      .then(a=>a.text())\n      .then(a=>{\n        const html = loader(a);\n        this.cache[key] = this.embbedInSection(html);\n        this.loadContent(true);\n      })\n      .catch(a=>console.error(a));\n\n    return this.embbedInSection('loading...');\n  }\n  renderGenProp(property){\n    return `\n    <h2>${property.accession}</h2>\n      <h3>${property.name}</h3>\n      <span class=\"tag\">${property.type}</span> <span class=\"tag secondary\">Threshold: ${property.threshold}</span>\n      <br/><br/>\n      <div class=\"row\">\n        <h4>Description</h4>\n        <p>${this.renderDescription(property.description, property.accession)}</p>\n      </div>\n      <div class=\"row\">\n        <h4>Steps</h4>\n        <div class=\"medium-3 columns\">\n          <ul class=\"vertical tabs\" data-tabs id=\"step-tabs\">\n            ${property.steps.map((step,i) => `\n              <li class=\"tabs-title ${i===0?'is-active':''}\">\n                <a target=\"#panel${step.number}\" ${i===0?'aria-selected=\"true\"':''}>\n                  ${step.number}. ${step.id}\n                </a>\n              </li>\n            `).join('')}\n          </ul>\n        </div>\n        <div class=\"medium-9 columns\">\n          <div class=\"tabs-content\" data-tabs-content=\"step-tabs\">\n          ${property.steps.map((step,i) => `\n            <div class=\"tabs-panel ${i===0?'is-active':''}\" id=\"panel${step.number}\">\n              <h5>${step.id}</h5>\n              ${step.requires===\"1\"?'<span class=\"tag\">Required</span>':''}\n              <table>\n                <tr>\n                  <th>Evidence</th>\n                  <th>Go Terms</th>\n                </tr>\n                ${step.evidence_list.map((e,i) => `\n                  <tr>\n                    <td>${this.renderEvidence(e.evidence)}</td>\n                    <td>${this.renderEvidence(e.go)}</td>\n                  </tr>\n                `).join('')}\n              </table>\n            </div>\n          `).join('')}\n          </div>\n        </div>\n      </div>\n      <div class=\"row\">\n        <h4>Database Links</h4>\n        <ul>\n          ${property.databases.map(db => `\n            <li>${this.renderDatabaseLink(db.title, db.link)}</li>\n          `).join('')}\n        </ul>\n      </div>\n      <div class=\"row\">\n        <h4>References</h4>\n        <ul class=\"references\">\n          ${property.references.map(ref => `\n              <li class=\"reference\" id=\"${property.accession}-${ref.number}\">\n                <span class=\"index\">[${ref.number}]</span>\n                <span class=\"authors\">${ref.author}</span>\n                <span class=\"title\">${ref.title}</span>\n                <span class=\"citation\">${ref.citation}</span>\n                <span class=\"reference_id\">${ref.PMID}</span>\n                <a target=\"_blank\" rel=\"noopener\" href=\"https://europepmc.org/abstract/MED/${ref.PMID}\">EuropePMC</a>\n              </li>\n          `).join('')}\n        </ul>\n      </div>\n\n    `;\n  }\n  renderDescription(txt, acc){\n    return txt.replace(/\\[(\\d+)\\]/g, `<a href=\"#${acc}-$1\">[$1]</a>`);\n  }\n  renderDatabaseLink(title, link){\n    let a = link;\n    const parts = link.split(';').map(p => p.trim());\n    if (parts[0] === 'KEGG')\n      a = `<a\n        href=\"http://www.genome.jp/dbget-bin/www_bget?pathway:${parts[1]}\"\n      >KEGG</a>`;\n    else if (parts[0] === 'IUBMB')\n      a = `<a\n        href=\"http://www.chem.qmul.ac.uk/iubmb/enzyme/reaction/${parts[1]}/${parts[2]}.html\"\n      >IUBMB</a>`\n    else if (parts[0] === 'MetaCyc')\n      a = `<a\n        href=\"https://metacyc.org/META/NEW-IMAGE?type=NIL&object=${parts[1]}\"\n      >MetaCyc</a>`\n    return `<b>${title}</b>: ${a}`;\n  }\n  renderEvidence(txt){\n    if (!txt) return '';\n    const parts = txt.split(';');\n    return parts\n      .filter(p => p.trim()!=='')\n      .map(t => {\n        const term = t.trim();\n        if (term.startsWith(\"GO:\"))\n          return `<a href=\"http://www.ebi.ac.uk/QuickGO/GTerm?id=${term}\">${term}</a>`\n        if (term.startsWith(\"GenProp\"))\n          return `<a href=\"#${term}\">${term}</a>`\n        if (term.startsWith(\"IPR\"))\n          return `<a href=\"https://www.ebi.ac.uk/interpro/entry/${term}\">${term}</a>`\n        if (term.startsWith(\"TIGR\"))\n          return `<a href=\"http://www.jcvi.org/cgi-bin/tigrfams/HmmReportPage.cgi?acc=${term}\">${term}</a>`\n        else {\n          return term;\n        }\n      }).join(' - ')\n  }\n  renderGenPropHierarchy(hierarchy, expanded=true, level=1){\n    return `\n    <div class=\"genome-property ${expanded?'expanded':''}\">\n      <header>\n        ${!hierarchy.children.length?'・':`\n        <a style=\"border: 0;color: darkred;\">${expanded?'▾':'▸'}</a>\n        `}\n        <a href=\"#${hierarchy.id}\">${hierarchy.id}</a>: ${hierarchy.name}\n      </header>\n      ${!hierarchy.children.length?'':`\n        <div class=\"children\" style=\"\n          margin-left: ${level*10}px;\n        \">\n          ${hierarchy.children\n            .map(child => this.renderGenPropHierarchy(child, false, level+1))\n            .join('')}\n        </div>\n      `}\n    </div>\n    `;\n  }\n  getViewerHTML() {\n    return `\n      <div class=\"container\">\n        <div class=\"top-block\">\n            <div id=\"gp-controllers\" class=\"top-controllers\">\n                <div>\n                    <header>Taxonomy Options</header>\n                    <ul>\n                        <li><label for=\"tax-search\">Search:</label>\n                            <input type=\"text\" id=\"tax-search\">\n                        </li>\n                        <li>\n                            <label for=\"newfile\">Upload File: </label>\n                            <input type=\"file\" id=\"newfile\"/>\n                        </li>\n                        <li><input type=\"checkbox\" id=\"collapse_tree\" checked=\"checked\"/><label for=\"collapse_tree\">Collapse tree</label></li>\n                        <li><label for=\"tax_label\">Labels:</label>\n                            <select id=\"tax_label\">\n                                <option value=\"name\">Species</option>\n                                <option value=\"id\">Tax ID</option>\n                                <option value=\"both\">Both</option>\n                            </select>\n                        </li>\n\n                    </ul>\n                </div>\n                <div>\n                    <header>Genome Properties Options</header>\n                    <ul>\n                        <li><label for=\"gp-selector\">Top level category:</label><br/>\n                            <div id=\"gp-selector\" class=\"selector\"></div>\n                        </li>\n                        <li><label for=\"gp-filter\">Filter:</label><br/>\n                            <input type=\"text\" id=\"gp-filter\">\n                        </li>\n                        <li><label for=\"gp_label\">Label:</label><br/>\n                            <select id=\"gp_label\">\n                                <option value=\"name\">Name</option>\n                                <option value=\"id\">ID</option>\n                                <option value=\"both\">Both</option>\n                            </select>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"gp-legends\">\n                    <header>Legends</header>\n                </div>\n                <a class=\"minimise\"></a>\n            </div>\n        </div>\n        <div id=\"gp-viewer\"></div>\n        <div class=\"info-tooltip\"></div>\n    </div>`\n  }\n  getGenProp(acc){\n    const url = `https://raw.githubusercontent.com/rdfinn/genome-properties/master/data/${acc}/DESC`\n    return this.getResource(acc, url, txt => this.renderGenProp(parseGenProp(txt)))\n  }\n  getHome(){\n    return this.getResource('home', 'https://raw.githubusercontent.com/rdfinn/genome-properties/master/docs/background.rst', this.markup2html)\n  }\n  getDocs(){\n    return this.getResource('docs', 'https://raw.githubusercontent.com/rdfinn/genome-properties/master/docs/index.rst', this.markup2html)\n  }\n  getProps(){\n    return this.getResource('props', 'files/gp.dag2.txt', txt => {\n      return '<h1>Hierarchy</h1>'+this.renderGenPropHierarchy(parseGenPropHierarchy(txt)['GenProp0065'])\n      // return `<pre>${JSON.stringify(parseGenPropHierarchy(txt)['GenProp0065'], null, ' ')}</pre>`;\n    })\n  }\n}\n\nexport default GenomePropertiesWebsite;\n"],"names":["mainKeys","refKeys","stepKeys","parseGenProp","txt","property","currentRef","currentDB","currentStep","currentEV","split","forEach","key","line","substr","value","trim","number","Number","replace","references","push","title","databases","description","notes","steps","evidence","evidence_list","parseGenPropHierarchy","ignore","hierarchy","parts","indexOf","children","GenomePropertiesWebsite","selector","container","document","querySelector","onhashchange","loadContent","cache","onclick","ev","target","localName","parentNode","className","querySelectorAll","e","setAttribute","classList","remove","add","getAttribute","expanded","innerHTML","onchange","log","id","oFiles","getElementById","files","i","length","reader","FileReader","fileToRead","onload","evt","load_genome_properties_text","name","result","readAsText","pageRequiredToChange","location","hash","getHome","getDocs","getProps","getViewerHTML","d3","gpv","GenomePropertiesViewer","viewer","select","on","d","c","classed","selectAll","style","transition","match","getGenProp","html","converter","showdown","Converter","makeHtml","url","loader","then","a","text","embbedInSection","catch","console","error","accession","type","threshold","renderDescription","map","step","join","requires","renderEvidence","go","renderDatabaseLink","db","link","ref","author","citation","PMID","acc","p","filter","term","t","startsWith","level","renderGenPropHierarchy","child","getResource","renderGenProp","markup2html"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,WAAW;MACX,WADW;MAEX,MAFW;MAGX,MAHW;MAIX;CAJN;AAMA,IAAMC,UAAU;MACV,MADU;MAEV,OAFU;MAGV,QAHU;MAIV;CAJN;AAMA,IAAMC,WAAW;MACX,IADW;MAEX,MAFW;MAGX;CAHN;AAKA,IAAMC,eAAe,SAAfA,YAAe,CAACC,GAAD,EAAS;MACtBC,WAAW;gBACH,EADG;eAEJ,EAFI;WAGR,EAHQ;iBAIF,EAJE;WAKR;GALT;MAOIC,aAAa,IAAjB;MACIC,YAAY,IAAhB;MACIC,cAAc,IAAlB;MACIC,YAAY,IAAhB;MACIC,KAAJ,CAAU,IAAV,EAAgBC,OAAhB,CAAwB,gBAAM;QACtBC,MAAMC,KAAKC,MAAL,CAAY,CAAZ,EAAc,CAAd,CAAZ;QACMC,QAAQF,KAAKC,MAAL,CAAY,CAAZ,EAAeE,IAAf,EAAd;QACIJ,OAAOZ,QAAX,EAAqBK,SAASL,SAASY,GAAT,CAAT,IAA0BG,KAA1B;;;QAGjBH,QAAQ,IAAZ,EAAkB;mBACH,EAACK,QAAQC,OAAOH,MAAMI,OAAN,CAAc,GAAd,EAAkB,EAAlB,EAAsBA,OAAtB,CAA8B,GAA9B,EAAkC,EAAlC,CAAP,CAAT,EAAb;eACSC,UAAT,CAAoBC,IAApB,CAAyBf,UAAzB;;QAEEM,OAAOX,OAAP,IAAkBK,UAAtB,EAAkCA,WAAWL,QAAQW,GAAR,CAAX,IAA2BG,KAA3B;;;QAG9BH,QAAQ,IAAZ,EAAkB;kBACJ,EAACU,OAAOP,KAAR,EAAZ;eACSQ,SAAT,CAAmBF,IAAnB,CAAwBd,SAAxB;;QAEEK,QAAQ,IAAR,IAAgBL,SAApB,EAA+BA,UAAU,MAAV,IAAoBQ,KAApB;;;QAG3BH,QAAQ,IAAZ,EAAkBP,SAASmB,WAAT,IAAwBT,QAAQ,GAAhC;;;QAGdH,QAAQ,IAAZ,EAAkBP,SAASoB,KAAT,IAAkBV,QAAQ,GAA1B;;;QAGdH,QAAQ,IAAZ,EAAkB;oBACF;gBACJM,OAAOH,KAAP,CADI;uBAEG;OAFjB;eAISW,KAAT,CAAeL,IAAf,CAAoBb,WAApB;;QAEEI,OAAOV,QAAP,IAAmBM,WAAvB,EAAoCA,YAAYN,SAASU,GAAT,CAAZ,IAA6BG,KAA7B;;QAEhCH,QAAQ,IAAR,IAAgBJ,WAApB,EAAiC;kBACnB,EAACmB,UAAUZ,KAAX,EAAZ;kBACYa,aAAZ,CAA0BP,IAA1B,CAA+BZ,SAA/B;;QAEEG,QAAQ,IAAR,IAAgBJ,WAAhB,IAA+BC,SAAnC,EAA8CA,UAAU,IAAV,IAAkBM,KAAlB;GAvChD;SA0COV,QAAP;;;CAtDF,CA4DA;;AC7EA,IAAMwB,wBAAwB,SAAxBA,qBAAwB,CAACzB,GAAD,EAAS;MAC/B0B,SAAS,CAAC,aAAD,CAAf;MACMC,YAAY,EAAlB;MACIrB,KAAJ,CAAU,IAAV,EAAgBC,OAAhB,CAAwB,gBAAQ;QACxBqB,QAAQnB,KAAKH,KAAL,CAAW,IAAX,CAAd;QACIsB,MAAM,CAAN,EAAShB,IAAT,OAAoB,EAApB,IACAc,OAAOG,OAAP,CAAeD,MAAM,CAAN,CAAf,KAA0B,CAAC,CAD3B,IAEAF,OAAOG,OAAP,CAAeD,MAAM,CAAN,CAAf,KAA0B,CAAC,CAF/B,EAGE;UACI,EAAEA,MAAM,CAAN,KAAYD,SAAd,CAAJ,EACEA,UAAUC,MAAM,CAAN,CAAV,IAAsB;YAChBA,MAAM,CAAN,CADgB;cAEdA,MAAM,CAAN,CAFc;;kBAIV;OAJZ;UAME,EAAEA,MAAM,CAAN,KAAYD,SAAd,CAAJ,EACEA,UAAUC,MAAM,CAAN,CAAV,IAAsB;YAChBA,MAAM,CAAN,CADgB;cAEdA,MAAM,CAAN,CAFc;;kBAIV;OAJZ;gBAMQA,MAAM,CAAN,CAAV,EAAoBE,QAApB,CAA6Bb,IAA7B,CAAkCU,UAAUC,MAAM,CAAN,CAAV,CAAlC;;GApBJ;SAuBOD,SAAP;CA1BF,CA6BA;;;;;;AC7BA,AACA,AACA,IAEMI;mCACQC,QAAZ,EAAsB;;;;;SACfA,QAAL,GAAgBA,QAAhB;SACKC,SAAL,GAAiBC,SAASC,aAAT,CAAuBH,QAAvB,CAAjB;WACOI,YAAP,GAAsB;aAAM,MAAKC,WAAL,EAAN;KAAtB;SACKC,KAAL,GAAa,EAAb;SACKD,WAAL;WACOE,OAAP,GAAiB,UAASC,EAAT,EAAY;UACvBA,GAAGC,MAAH,CAAUC,SAAV,KAAwB,GAAxB,IACAF,GAAGC,MAAH,CAAUE,UAAV,CAAqBD,SAArB,KAAmC,IADnC,IAEAF,GAAGC,MAAH,CAAUE,UAAV,CAAqBC,SAArB,CAA+Bf,OAA/B,CAAuC,YAAvC,IAAqD,CAAC,CAF1D,EAGC;iBACUgB,gBAAT,CAA0B,iBAA1B,EAA6CtC,OAA7C,CAAqD;iBAAGuC,EAAEC,YAAF,CAAe,eAAf,EAAgC,IAAhC,CAAH;SAArD;iBACSF,gBAAT,CAA0B,eAA1B,EAA2CtC,OAA3C,CAAmD;iBAAGuC,EAAEE,SAAF,CAAYC,MAAZ,CAAmB,WAAnB,CAAH;SAAnD;WACGR,MAAH,CAAUM,YAAV,CAAuB,eAAvB,EAAwC,IAAxC;WACGN,MAAH,CAAUE,UAAV,CAAqBK,SAArB,CAA+BE,GAA/B,CAAmC,WAAnC;iBACSL,gBAAT,CAA0B,8CAA1B,EAA0EtC,OAA1E,CAAkF;iBAAGuC,EAAEE,SAAF,CAAYC,MAAZ,CAAmB,WAAnB,CAAH;SAAlF;YACMR,SAASD,GAAGC,MAAH,CAAUU,YAAV,CAAuB,QAAvB,CAAf;iBACShB,aAAT,CAAuBM,MAAvB,EAA+BO,SAA/B,CAAyCE,GAAzC,CAA6C,WAA7C;OAVF,MAWO,IAAIV,GAAGC,MAAH,CAAUC,SAAV,KAAwB,GAAxB,IACTF,GAAGC,MAAH,CAAUE,UAAV,CAAqBD,SAArB,KAAmC,QAD1B,IAETF,GAAGC,MAAH,CAAUE,UAAV,CAAqBA,UAArB,CAAgCD,SAAhC,KAA8C,KAFrC,IAGTF,GAAGC,MAAH,CAAUE,UAAV,CAAqBA,UAArB,CAAgCC,SAAhC,CAA0Cf,OAA1C,CAAkD,iBAAlD,IAAqE,CAAC,CAHjE,EAIN;YACOuB,WAAUZ,GAAGC,MAAH,CAAUE,UAAV,CAAqBA,UAArB,CAAgCC,SAAhC,CAA0Cf,OAA1C,CAAkD,UAAlD,IAAgE,CAAC,CAAjF;YACIuB,QAAJ,EAAa;aACRX,MAAH,CAAUY,SAAV,GAAsB,GAAtB;aACGZ,MAAH,CAAUE,UAAV,CAAqBA,UAArB,CAAgCK,SAAhC,CAA0CC,MAA1C,CAAiD,UAAjD;SAFF,MAGO;aACFR,MAAH,CAAUY,SAAV,GAAsB,GAAtB;aACGZ,MAAH,CAAUE,UAAV,CAAqBA,UAArB,CAAgCK,SAAhC,CAA0CE,GAA1C,CAA8C,UAA9C;;;KAvBN;WA2BOI,QAAP,GAAkB,UAASd,EAAT,EAAY;cACpBe,GAAR,CAAYf,GAAGC,MAAH,CAAUe,EAAtB;UACIhB,GAAGC,MAAH,CAAUe,EAAV,KAAe,SAAnB,EAA6B;;YAErBC,SAASvB,SAASwB,cAAT,CAAwB,SAAxB,EAAmCC,KAAlD;aACK,IAAIC,IAAE,CAAX,EAAcA,IAAIH,OAAOI,MAAzB,EAAiCD,GAAjC,EAAqC;cAC3BE,SAAS,IAAIC,UAAJ,EAAf;iBACOC,UAAP,GAAoBP,OAAOG,CAAP,CAApB;iBACOK,MAAP,GAAgB,UAASC,GAAT,EAAc;mBACnBC,2BAAP,CAAmCD,IAAIzB,MAAJ,CAAWuB,UAAX,CAAsBI,IAAzD,EAA+DF,IAAIzB,MAAJ,CAAW4B,MAA1E;WADJ;iBAGOC,UAAP,CAAkBb,OAAOG,CAAP,CAAlB;;;KAXR;;;;;kCAgBsC;UAA5BW,oBAA4B,uEAAP,KAAO;;cAC9BC,SAASC,IAAjB;aACO,OAAL,CAAc,KAAK,EAAL;eACPxC,SAAL,CAAeoB,SAAf,GAA2B,KAAKqB,OAAL,EAA3B;;aAEG,OAAL;eACOzC,SAAL,CAAeoB,SAAf,GAA2B,KAAKsB,OAAL,EAA3B;;aAEG,aAAL;eACO1C,SAAL,CAAeoB,SAAf,GAA2B,KAAKuB,QAAL,EAA3B;;aAEG,SAAL;eACO3C,SAAL,CAAeoB,SAAf,GAA2B,KAAKwB,aAAL,EAA3B;cACIC,KAAKC,IAAID,EAAb;cACQE,yBAAyBD,IAAIC,sBADrC;cAEQC,SAAS,IAAID,sBAAJ,CAA2B;8BACd,YADc;yCAEH,cAFG;oBAGxB,yDAHwB;4BAIhB,oBAJgB;4BAKhB,iHALgB;wBAMpB,uBANoB;oBAOxB;WAPH,CAFjB;iBAWSC,MAAP,GAAgBA,MAAhB;aACGC,MAAH,CAAU,WAAV,EAAuBC,EAAvB,CAA0B,OAA1B,EAAkC,UAACC,CAAD,EAAGxB,CAAH,EAAKyB,CAAL,EAAS;gBACjCF,KAAKL,GAAGI,MAAH,CAAUG,EAAEzB,CAAF,CAAV,EAAgB0B,OAAhB,CAAwB,IAAxB,CAAX;eACGC,SAAH,CAAa,sBAAb,EACSC,KADT,CACe,YADf,EAC6BL,KAAG,KAAH,GAAS,OADtC,EAESK,KAFT,CAEe,UAFf,EAE2BL,KAAG,IAAH,GAAQ,QAFnC,EAGSM,UAHT,CAGoB,GAHpB,EAISD,KAJT,CAIe,YAJf,EAI6BL,KAAG,OAAH,GAAW,KAJxC,EAKSK,KALT,CAKe,SALf,EAK0BL,KAAG,CAAH,GAAK,CAL/B;eAMGI,SAAH,CAAa,kBAAb,EAAiCE,UAAjC,CAA4C,GAA5C,EAAiDD,KAAjD,CAAuD,SAAvD,EAAkEL,KAAG,KAAH,GAAS,KAA3E;eACGD,MAAH,CAAUG,EAAEzB,CAAF,CAAV,EAAgB0B,OAAhB,CAAwB,IAAxB,EAA8B,CAACH,EAA/B;WATJ;;;cAaEX,SAASC,IAAT,CAAciB,KAAd,CAAoB,iBAApB,CAAJ,EAA2C;iBACpCzD,SAAL,CAAeoB,SAAf,GAA2B,KAAKsC,UAAL,CAAgBnB,SAASC,IAAT,CAAc/D,MAAd,CAAqB,CAArB,CAAhB,CAA3B;;;cAGE6D,oBAAJ,EACE,KAAKtC,SAAL,CAAeoB,SAAf,GAA2B,gBAA3B;;;;;;oCAIQuC,MAAK;0EAIbA,IAHN;;;;gCASU5F,KAAKQ,KAAK;UACdqF,YAAY,IAAIC,SAASC,SAAb,EAAlB;aACOF,UAAUG,QAAV,CAAmBhG,GAAnB,CAAP;;;;gCAEUQ,KAAKyF,KAAKC,QAAO;;;UACvB1F,OAAO,KAAK8B,KAAhB,EACE,OAAO,KAAKA,KAAL,CAAW9B,GAAX,CAAP;YACIyF,GAAN,EACGE,IADH,CACQ;eAAGC,EAAEC,IAAF,EAAH;OADR,EAEGF,IAFH,CAEQ,aAAG;YACDP,OAAOM,OAAOE,CAAP,CAAb;eACK9D,KAAL,CAAW9B,GAAX,IAAkB,OAAK8F,eAAL,CAAqBV,IAArB,CAAlB;eACKvD,WAAL,CAAiB,IAAjB;OALJ,EAOGkE,KAPH,CAOS;eAAGC,QAAQC,KAAR,CAAcL,CAAd,CAAH;OAPT;;aASO,KAAKE,eAAL,CAAqB,YAArB,CAAP;;;;kCAEYrG,UAAS;;;4BAEfA,SAASyG,SADf,yBAEQzG,SAASmE,IAFjB,yCAGsBnE,SAAS0G,IAH/B,yDAGqF1G,SAAS2G,SAH9F,uGAOS,KAAKC,iBAAL,CAAuB5G,SAASmB,WAAhC,EAA6CnB,SAASyG,SAAtD,CAPT,wMAaUzG,SAASqB,KAAT,CAAewF,GAAf,CAAmB,UAACC,IAAD,EAAMnD,CAAN;4DACKA,MAAI,CAAJ,GAAM,WAAN,GAAkB,EADvB,gDAEEmD,KAAKlG,MAFP,YAEkB+C,MAAI,CAAJ,GAAM,sBAAN,GAA6B,EAF/C,8BAGbmD,KAAKlG,MAHQ,UAGGkG,KAAKvD,EAHR;OAAnB,EAMCwD,IAND,CAMM,EANN,CAbV,uKAwBQ/G,SAASqB,KAAT,CAAewF,GAAf,CAAmB,UAACC,IAAD,EAAMnD,CAAN;2DACMA,MAAI,CAAJ,GAAM,WAAN,GAAkB,EADxB,sBACwCmD,KAAKlG,MAD7C,+BAEXkG,KAAKvD,EAFM,8BAGfuD,KAAKE,QAAL,KAAgB,GAAhB,GAAoB,mCAApB,GAAwD,EAHzC,yKASbF,KAAKvF,aAAL,CAAmBsF,GAAnB,CAAuB,UAAChE,CAAD,EAAGc,CAAH;wEAEf,OAAKsD,cAAL,CAAoBpE,EAAEvB,QAAtB,CAFe,uCAGf,OAAK2F,cAAL,CAAoBpE,EAAEqE,EAAtB,CAHe;SAAvB,EAKCH,IALD,CAKM,EALN,CATa;OAAnB,EAiBCA,IAjBD,CAiBM,EAjBN,CAxBR,8IAgDQ/G,SAASkB,SAAT,CAAmB2F,GAAnB,CAAuB;sCACjB,OAAKM,kBAAL,CAAwBC,GAAGnG,KAA3B,EAAkCmG,GAAGC,IAArC,CADiB;OAAvB,EAECN,IAFD,CAEM,EAFN,CAhDR,4IAwDQ/G,SAASe,UAAT,CAAoB8F,GAApB,CAAwB;iEACM7G,SAASyG,SADf,SAC4Ba,IAAI1G,MADhC,oDAEG0G,IAAI1G,MAFP,0DAGI0G,IAAIC,MAHR,uDAIED,IAAIrG,KAJN,0DAKKqG,IAAIE,QALT,8DAMSF,IAAIG,IANb,iHAOyDH,IAAIG,IAP7D;OAAxB,EASCV,IATD,CASM,EATN,CAxDR;;;;sCAuEgBhH,KAAK2H,KAAI;aAClB3H,IAAIe,OAAJ,CAAY,YAAZ,kBAAuC4G,GAAvC,oBAAP;;;;uCAEiBzG,OAAOoG,MAAK;UACzBlB,IAAIkB,IAAR;UACM1F,QAAQ0F,KAAKhH,KAAL,CAAW,GAAX,EAAgBwG,GAAhB,CAAoB;eAAKc,EAAEhH,IAAF,EAAL;OAApB,CAAd;UACIgB,MAAM,CAAN,MAAa,MAAjB,EACEwE,4EAC0DxE,MAAM,CAAN,CAD1D,yBADF,KAIK,IAAIA,MAAM,CAAN,MAAa,OAAjB,EACHwE,6EAC2DxE,MAAM,CAAN,CAD3D,SACuEA,MAAM,CAAN,CADvE,+BADG,KAIA,IAAIA,MAAM,CAAN,MAAa,SAAjB,EACHwE,+EAC6DxE,MAAM,CAAN,CAD7D;qBAGWV,KAAb,cAA2BkF,CAA3B;;;;mCAEapG,KAAI;UACb,CAACA,GAAL,EAAU,OAAO,EAAP;UACJ4B,QAAQ5B,IAAIM,KAAJ,CAAU,GAAV,CAAd;aACOsB,MACJiG,MADI,CACG;eAAKD,EAAEhH,IAAF,OAAW,EAAhB;OADH,EAEJkG,GAFI,CAEA,aAAK;YACFgB,OAAOC,EAAEnH,IAAF,EAAb;YACIkH,KAAKE,UAAL,CAAgB,KAAhB,CAAJ,EACE,4DAAyDF,IAAzD,WAAkEA,IAAlE;YACEA,KAAKE,UAAL,CAAgB,SAAhB,CAAJ,EACE,uBAAoBF,IAApB,WAA6BA,IAA7B;YACEA,KAAKE,UAAL,CAAgB,KAAhB,CAAJ,EACE,2DAAwDF,IAAxD,WAAiEA,IAAjE;YACEA,KAAKE,UAAL,CAAgB,MAAhB,CAAJ,EACE,iFAA8EF,IAA9E,WAAuFA,IAAvF,UADF,KAEK;iBACIA,IAAP;;OAbC,EAeFd,IAfE,CAeG,KAfH,CAAP;;;;2CAiBqBrF,WAAkC;;;UAAvByB,QAAuB,uEAAd,IAAc;UAAR6E,KAAQ,uEAAF,CAAE;;sDAEzB7E,WAAS,UAAT,GAAoB,EADlD,uCAGM,CAACzB,UAAUG,QAAV,CAAmB+B,MAApB,GAA2B,GAA3B,0DACqCT,WAAS,GAAT,GAAa,GADlD,oBAHN,8BAMgBzB,UAAU6B,EAN1B,WAMiC7B,UAAU6B,EAN3C,cAMsD7B,UAAUyC,IANhE,kCAQI,CAACzC,UAAUG,QAAV,CAAmB+B,MAApB,GAA2B,EAA3B,2EAEiBoE,QAAM,EAFvB,oCAIItG,UAAUG,QAAV,CACCgF,GADD,CACK;eAAS,OAAKoB,sBAAL,CAA4BC,KAA5B,EAAmC,KAAnC,EAA0CF,QAAM,CAAhD,CAAT;OADL,EAECjB,IAFD,CAEM,EAFN,CAJJ,6BARJ;;;;oCAoBc;;;;;+BAsDLW,KAAI;;;UACP1B,kFAAgF0B,GAAhF,UAAN;aACO,KAAKS,WAAL,CAAiBT,GAAjB,EAAsB1B,GAAtB,EAA2B;eAAO,OAAKoC,aAAL,CAAmBtI,aAAaC,GAAb,CAAnB,CAAP;OAA3B,CAAP;;;;8BAEO;aACA,KAAKoI,WAAL,CAAiB,MAAjB,EAAyB,uFAAzB,EAAkH,KAAKE,WAAvH,CAAP;;;;8BAEO;aACA,KAAKF,WAAL,CAAiB,MAAjB,EAAyB,kFAAzB,EAA6G,KAAKE,WAAlH,CAAP;;;;+BAEQ;;;aACD,KAAKF,WAAL,CAAiB,OAAjB,EAA0B,mBAA1B,EAA+C,eAAO;eACpD,uBAAqB,OAAKF,sBAAL,CAA4BzG,sBAAsBzB,GAAtB,EAA2B,aAA3B,CAA5B,CAA5B;;OADK,CAAP;;;;;IAOJ;;;;"}